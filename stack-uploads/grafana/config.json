{
  "name": "grafana",
  "displayName": "Grafana Analytics",
  "description": "Dashboard de monitoramento e visualização de dados",
  "version": "10.2.0",
  "category": "monitoring",
  "config": {
    "database": {
      "type": "postgres",
      "host": "${DATABASE_HOST}",
      "name": "grafana",
      "user": "${DATABASE_USER}",
      "password": "${DATABASE_PASSWORD}",
      "ssl_mode": "disable"
    },
    "server": {
      "http_port": 3000,
      "domain": "grafana.${DOMAIN}",
      "root_url": "https://grafana.${DOMAIN}",
      "serve_from_sub_path": false
    },
    "security": {
      "admin_user": "admin",
      "admin_password": "${GRAFANA_ADMIN_PASSWORD}",
      "secret_key": "${GRAFANA_SECRET_KEY}",
      "disable_gravatar": true,
      "allow_sign_up": false
    },
    "auth": {
      "anonymous": {
        "enabled": false
      },
      "basic": {
        "enabled": true
      }
    },
    "datasources": [
      {
        "name": "Prometheus",
        "type": "prometheus",
        "url": "http://prometheus:9090",
        "access": "proxy",
        "isDefault": true
      },
      {
        "name": "PostgreSQL",
        "type": "postgres",
        "url": "${DATABASE_HOST}:5432",
        "database": "kryonix",
        "user": "${DATABASE_USER}",
        "password": "${DATABASE_PASSWORD}"
      }
    ],
    "dashboards": {
      "default_home_dashboard_path": "/etc/grafana/dashboards/kryonix-overview.json"
    }
  },
  "environment_variables": [
    "DATABASE_HOST",
    "DATABASE_USER",
    "DATABASE_PASSWORD",
    "GRAFANA_ADMIN_PASSWORD",
    "GRAFANA_SECRET_KEY",
    "DOMAIN"
  ],
  "docker_compose": {
    "image": "grafana/grafana:10.2.0",
    "ports": ["3002:3000"],
    "volumes": [
      "grafana_data:/var/lib/grafana",
      "./grafana/dashboards:/etc/grafana/dashboards",
      "./grafana/provisioning:/etc/grafana/provisioning"
    ],
    "environment": {
      "GF_DATABASE_TYPE": "postgres",
      "GF_DATABASE_HOST": "${DATABASE_HOST}:5432",
      "GF_DATABASE_NAME": "grafana",
      "GF_DATABASE_USER": "${DATABASE_USER}",
      "GF_DATABASE_PASSWORD": "${DATABASE_PASSWORD}",
      "GF_SECURITY_ADMIN_PASSWORD": "${GRAFANA_ADMIN_PASSWORD}",
      "GF_SERVER_DOMAIN": "grafana.${DOMAIN}",
      "GF_SERVER_ROOT_URL": "https://grafana.${DOMAIN}"
    }
  },
  "health_check": {
    "url": "/api/health",
    "method": "GET",
    "expected_status": 200,
    "interval": 30
  }
}
